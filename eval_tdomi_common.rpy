label eval_tdomi_common:

    #Backgrounds
    image evalwildlands = "bg/evalwildlands.jpg" #Tysm EvilChaosKnight
    image evalwildlands2 = "bg/evalwildlands2.jpg" #Tysm again ECK
    image evalpark1 = "bg/evalpark1.jpg"
    image evalpark2 = "bg/evalpark2.jpg"
    image evalplayerapt1 = "bg/evalplayerapt1.jpg"
    image evalplayerapt2 = "bg/evalplayerapt2.jpg"
    image evalkatsucart = "bg/evalkatsucart.jpg"
    image evalorphlight = "bg/evalorphlight.jpg"
    image evalorphevening = "bg/evalorphevening.jpg"
    image evalorphdark = "bg/evalorphdark.jpg"
    image evalplayerkitchen = "bg/evalplayerkitchen.jpg" #Tysm again again ECK
    image evalportalb = "bg/evalportalb.png"
    image evalgoggleoverlay = "bg/evalgoggleoverlay.png"

    #Credits
    image evalcustomcredits1 = "cg/evalcustomcredits1.png"

    #Characters

    #Amely brought to you by ECK
    image amely smnormal = "cr/amely_smnormal.png"
    image amely smnormal flip = "cr/amely_smnormal_flip.png"
    image amely sad = "cr/amely_sad.png"
    image amely sad flip = "cr/amely_sad_flip.png"
    image amely smsad = "cr/amely_smsad.png"
    image amely smsad flip = "cr/amely_smsad_flip.png"

    #Vara small
    image vara smnormal ghost = "cr/vara_smnormal_ghost.png"
    image vara smnormal ghost flip = im.Flip("cr/vara_smnormal_ghost.png", horizontal=True)
    image vara smnormal = "cr/vara_smnormal.png"
    image vara smnormal flip = im.Flip("cr/vara_smnormal.png", horizontal=True)
    image vara smsad = "cr/vara_smsad.png"
    image vara smsad flip = im.Flip("cr/vara_smsad.png", horizontal=True)
    image vara smnone = "cr/vara_smnone.png"
    image vara smnone flip = im.Flip("cr/vara_smnone.png", horizontal=True)
    image vara smgrowl = "cr/vara_smgrowl.png"
    image vara smgrowl flip = im.Flip("cr/vara_smgrowl.png", horizontal=True)
    image vara smshocked = "cr/vara_smshocked.png"
    image vara smshocked flip = im.Flip("cr/vara_smshocked.png", horizontal=True)
    image vara smshocked b = "cr/vara_smshocked_b.png"
    image vara smshocked b flip = im.Flip("cr/vara_smshocked_b.png", horizontal=True)
    image vara smsmile = "cr/vara_smsmile.png"
    image vara smsmile flip = im.Flip("cr/vara_smsmile.png", horizontal=True)

    #Remy wounded - Why a bullet on both sides? Well, I need him facing the right with the wound, and it felt weird to leave a non-flipped image in here as well
    image remy normal eval shot = "cr/remy_normal_eval_shot.png"
    image remy normal eval shot flip = im.Flip("cr/remy_normal_eval_shot.png", horizontal=True)
    image remy sad eval shot = "cr/remy_sad_e.png"
    image remy sad eval shot flip = im.Flip("cr/remy_sad_eval_shot.png", horizontal=True)
    image remy look eval shot = "cr/remy_look_e.png"
    image remy look eval shot flip = im.Flip("cr/remy_look_eval_shot.png", horizontal=True)
    image remy smile eval shot = "cr/remy_smile_e.png"
    image remy smile eval shot flip = im.Flip("cr/remy_smile_eval_shot.png", horizontal=True)
    image remy shy eval shot = "cr/remy_shy_e.png"
    image remy shy eval shot flip = im.Flip("cr/remy_shy_eval_shot.png", horizontal=True)
    image remy angry eval shot = "cr/remy_angry_e.png"
    image remy angry eval shot flip = im.Flip("cr/remy_angry_eval_shot.png", horizontal=True)

    #Adine ice cream face - Why doesn't this one make sense flipped either? I need the image flipped and can't be bothered to make a flipped sprite I won't use
    image adine normal eval icecream = "cr/adine_normal_eval_icecream.png"
    image adine normal eval icecream flip = im.Flip("cr/adine_normal_eval_icecream.png", horizontal=True)
    image adine annoyed eval icecream = "cr/adine_annoyed_eval_icecream.png"
    image adine annoyed eval icecream flip = im.Flip("cr/adine_annoyed_eval_icecream.png", horizontal=True)
    image adine disappoint eval icecream = "cr/adine_disappoint_eval_icecream.png"
    image adine disappoint eval icecream flip = im.Flip("cr/adine_disappoint_eval_icecream.png", horizontal=True)
    image adine frustrated eval icecream = "cr/adine_frustrated_eval_icecream.png"
    image adine frustrated eval icecream flip = im.Flip("cr/adine_frustrated_eval_icecream.png", horizontal=True)
    image adine giggle eval icecream = "cr/adine_giggle_eval_icecream.png"
    image adine giggle eval icecream flip = im.Flip("cr/adine_giggle_eval_icecream.png", horizontal=True)
    image adine sad eval icecream = "cr/adine_sad_eval_icecream.png"
    image adine sad eval icecream flip = im.Flip("cr/adine_sad_eval_icecream.png", horizontal=True)
    image adine think eval icecream = "cr/adine_think_eval_icecream.png"
    image adine think eval icecream flip = im.Flip("cr/adine_think_eval_icecream.png", horizontal=True)

    #Goggles - Some of these images aren't used, but I might as well add compatability for everything I have
    image amely smnormal goggles = "cr/amely_smnormal_goggles.png"
    image amely smnormal goggles flip = "cr/amely_smnormal_goggles_flip.png"
    image amely smsad goggles = "cr/amely_smsad_goggles.png"
    image amely smsad goggles flip = "cr/amely_smsad_goggles_flip.png"

    image remy normal goggles = "cr/remy_normal_goggles.png"
    image remy normal goggles flip = im.Flip("cr/remy_normal_goggles.png", horizontal=True)
    image remy look goggles = "cr/remy_look_goggles.png"
    image remy look goggles flip = im.Flip("cr/remy_look_goggles.png", horizontal=True)
    image remy shy goggles = "cr/remy_shy_goggles.png"
    image remy shy goggles flip = im.Flip("cr/remy_shy_goggles.png", horizontal=True)
    image remy sad goggles = "cr/remy_sad_goggles.png"
    image remy sad goggles flip = im.Flip("cr/remy_sad_goggles.png", horizontal=True)
    image remy smile goggles = "cr/remy_smile_goggles.png"
    image remy smile goggles flip = im.Flip("cr/remy_smile_goggles.png", horizontal=True)

    image vara smnone goggles = "cr/vara_smnone_goggles.png"
    image vara smnone goggles flip = im.Flip("cr/vara_smnone_goggles.png", horizontal=True)
    image vara smnormal goggles = "cr/vara_smnormal_goggles.png"
    image vara smnormal goggles flip = im.Flip("cr/vara_smnormal_goggles.png", horizontal=True)
    image vara smsmile goggles = "cr/vara_smsmile_goggles.png"
    image vara smsmile goggles flip = im.Flip("cr/vara_smsmile_goggles.png", horizontal=True)

    #Probably won't even use all these images. But if someone wants them here you go
    image adine annoyed goggles = "cr/adine_annoyed_goggles.png"
    image adine annoyed  goggles flip = im.Flip("cr/adine_annoyed_goggles.png", horizontal=True)
    image adine annoyed goggles b = "cr/adine_annoyed_goggles_b.png"
    image adine annoyed goggles b flip = im.Flip("cr/adine_annoyed_goggles_b.png", horizontal=True)
    image adine annoyed goggles c = "cr/adine_annoyed_goggles_c.png"
    image adine annoyed goggles c flip = im.Flip("cr/adine_annoyed_goggles_c.png", horizontal=True)
    image adine annoyed goggles d = "cr/adine_annoyed_goggles_d.png"
    image adine annoyed goggles d flip = im.Flip("cr/adine_annoyed_goggles_d.png", horizontal=True)
    image adine annoyed goggles e = "cr/adine_annoyed_goggles_e.png"
    image adine annoyed goggles e flip = im.Flip("cr/adine_annoyed_goggles_e.png", horizontal=True)
    image adine disappoint goggles = "cr/adine_disappoint_goggles.png"
    image adine disappoint goggles flip = im.Flip("cr/adine_disappoint_goggles.png", horizontal=True)
    image adine disappoint goggles b = "cr/adine_disappoint_goggles_b.png"
    image adine disappoint goggles b flip = im.Flip("cr/adine_disappoint_goggles_b.png", horizontal=True)
    image adine disappoint goggles c = "cr/adine_disappoint_goggles_c.png"
    image adine disappoint goggles c flip = im.Flip("cr/adine_disappoint_goggles_c.png", horizontal=True)
    image adine disappoint goggles d = "cr/adine_disappoint_goggles_d.png"
    image adine disappoint goggles d flip = im.Flip("cr/adine_disappoint_goggles_d.png", horizontal=True)
    image adine disappoint goggles e = "cr/adine_disappoint_goggles_e.png"
    image adine disappoint goggles e flip = im.Flip("cr/adine_disappoint_goggles_e.png", horizontal=True)
    image adine frustrated goggles = "cr/adine_frustrated_goggles.png"
    image adine frustrated goggles flip = im.Flip("cr/adine_frustrated_goggles.png", horizontal=True)
    image adine frustrated goggles b = "cr/adine_frustrated_goggles_b.png"
    image adine frustrated goggles b flip = im.Flip("cr/adine_frustrated_goggles_b.png", horizontal=True)
    image adine frustrated goggles c = "cr/adine_frustrated_goggles_c.png"
    image adine frustrated goggles c flip = im.Flip("cr/adine_frustrated_goggles_c.png", horizontal=True)
    image adine frustrated goggles d = "cr/adine_frustrated_goggles_d.png"
    image adine frustrated goggles d flip = im.Flip("cr/adine_frustrated_goggles_d.png", horizontal=True)
    image adine frustrated goggles e = "cr/adine_frustrated_goggles_e.png"
    image adine frustrated goggles e flip = im.Flip("cr/adine_frustrated_goggles_e.png", horizontal=True)
    image adine giggle goggles = "cr/adine_giggle_goggles.png"
    image adine giggle goggles flip = im.Flip("cr/adine_giggle_goggles.png", horizontal=True)
    image adine giggle goggles b = "cr/adine_giggle_goggles_b.png"
    image adine giggle goggles b flip = im.Flip("cr/adine_giggle_goggles_b.png", horizontal=True)
    image adine giggle goggles c = "cr/adine_giggle_goggles_c.png"
    image adine giggle goggles c flip = im.Flip("cr/adine_giggle_goggles_c.png", horizontal=True)
    image adine giggle goggles d = "cr/adine_giggle_goggles_d.png"
    image adine giggle goggles d flip = im.Flip("cr/adine_giggle_goggles_d.png", horizontal=True)
    image adine normal goggles = "cr/adine_normal_goggles.png"
    image adine normal goggles flip = im.Flip("cr/adine_normal_goggles.png", horizontal=True)
    image adine normal goggles b = "cr/adine_normal_goggles_b.png"
    image adine normal goggles b flip = im.Flip("cr/adine_normal_goggles_b.png", horizontal=True)
    image adine normal goggles c = "cr/adine_normal_goggles_c.png"
    image adine normal goggles c flip = im.Flip("cr/adine_normal_goggles_c.png", horizontal=True)
    image adine normal goggles d = "cr/adine_normal_goggles_d.png"
    image adine normal goggles d flip = im.Flip("cr/adine_normal_goggles_d.png", horizontal=True)
    image adine normal goggles e = "cr/adine_normal_goggles_e.png"
    image adine normal goggles e flip = im.Flip("cr/adine_normal_goggles_e.png", horizontal=True)
    image adine sad goggles = "cr/adine_sad_goggles.png"
    image adine sad goggles flip = im.Flip("cr/adine_sad_goggles.png", horizontal=True)
    image adine sad goggles b = "cr/adine_sad_goggles_b.png"
    image adine sad goggles b flip = im.Flip("cr/adine_sad_goggles_b.png", horizontal=True)
    image adine sad goggles c = "cr/adine_sad_goggles_c.png"
    image adine sad goggles c flip = im.Flip("cr/adine_sad_goggles_c.png", horizontal=True)
    image adine sad goggles d = "cr/adine_sad_goggles_d.png"
    image adine sad goggles d flip = im.Flip("cr/adine_sad_goggles_d.png", horizontal=True)
    image adine sad goggles e = "cr/adine_sad_goggles_e.png"
    image adine sad goggles e flip = im.Flip("cr/adine_sad_goggles_e.png", horizontal=True)
    image adine think goggles = "cr/adine_think_goggles.png"
    image adine think goggles flip = im.Flip("cr/adine_think_goggles.png", horizontal=True)
    image adine think goggles b = "cr/adine_think_goggles_b.png"
    image adine think goggles b flip = im.Flip("cr/adine_think_goggles_b.png", horizontal=True)
    image adine think goggles c = "cr/adine_think_goggles_c.png"
    image adine think goggles c flip = im.Flip("cr/adine_think_goggles_c.png", horizontal=True)
    image adine think goggles d = "cr/adine_think_goggles_d.png"
    image adine think goggles d flip = im.Flip("cr/adine_think_goggles_d.png", horizontal=True)
    image adine sad goggles shot a = "cr/adine_sad_goggles_shot.png"
    image adine sad goggles shot a flip = im.Flip("cr/adine_sad_goggles_shot.png", horizontal=True)
    image adine sad goggles shot b = "cr/adine_sad_goggles_shot_b.png"
    image adine sad goggles shot b flip = im.Flip("cr/adine_sad_goggles_shot_b.png", horizontal=True)
    image adine sad goggles shot c = "cr/adine_sad_goggles_shot_c.png"
    image adine sad goggles shot c flip = im.Flip("cr/adine_sad_goggles_shot_c.png", horizontal=True)
    image adine sad goggles shot d = "cr/adine_sad_goggles_shot_d.png"
    image adine sad goggles shot d flip = im.Flip("cr/adine_sad_goggles_shot_d.png", horizontal=True)
    image adine sad goggles shot e = "cr/adine_sad_goggles_shot_e.png"
    image adine sad goggles shot e flip = im.Flip("cr/adine_sad_goggles_shot_e.png", horizontal=True)

    $ _game_menu_screen = "navigation"

    #Check if player has ridden Bryce in ECK's Savior Mod.
    $ evalRodeBryce = False #This is NOT weird I promise
    if persistent.eckbryceendingseena and persistent.eckbryceendingseena == "A":
        $ evalRodeBryce = True
    
    #Flavor you choose
    $ evalChosenFlavor = ""

    #Shows/hides the menu option for the special flavor
    $ evalShowSpecialFlavor = True

    #Shows/hides the menu option for spaghettieis
    $ evalShowSpaghettieis = True

    #Whether you have had spaghettieis explained
    $ evalExplainSpaghettieis = False

    #Tracks current ending (1 = solo remy, 2 = remy + amely, 3 = remy + amely + adine, 4 = everyone)
    $ evalCurrentEnding = 0

    #Whether you decide to switch cones with Remy
    $ evalSwitchedCones = False

    #Whether you sleep on Remy
    $ evalRemyPillow = False

    #Whether Amely pisses off everyone in line
    $ evalAmelyAnnoysLine = False

    #Whether you rode Remy or not <-- THIS IS NOT WEIRD AGAIN I PROMISE
    $ evalRodeRemy = False

    #Whether you asked if Remy called you fat in the first choice
    $ evalAskIfFat = False

    #Whether you manage to help out at the orphanage
    $ evalHelpOrphanage = False

    #How many times Adine has slapped you lol
    $ evalAdineSlaps = 0

    #How well the player did on the orphanage minigame. 0-2 - 0 bad - 1 good - 2 perfect
    $ evalOrphanageScore = 0

    #Whether you played Katsu's game
    $ evalPlayedKatsuGame = False

    #Whether you experienced my comedic genius
    $ evalSweatJoke = False

    #Whether you share the bed with Remy in the third ending
    $ evalRemyShareBed3 = False

    #Whether you visit the hatchery in chapter 4
    $ evalHatcheryVisited = False

    #Vara's mood during the chapter 4 Remy date change\
    $ evalVaraMood = 2

    #Whether you will actually get the secret ending or not
    $ evalPathToSecretComplete = False

    #Whether you have experienced the secret ending and currently in that timeline
    $ evalDoingSecretEnding = False

    #Whether you share the bed in the changed Ch4 Remy date
    $ evalRemyDateBed = False

    #Basically just a bugfix on a hook
    $ evalFixDoubleOrphanageLine = False

    #Whether you have the tape measure for a very bad joke
    $ evalTapeMeasure = False

    #Whether Adine tricks you
    $ evalAdineTrick = False

    #Whether you walk with Remy. Does some logic to account for sleeping
    $ evalScenicWalk = False

    #Whether you listen to Katsu's music
    $ evalKatsuMusic = False

    #Whether you heard a specific bad joke from Remy
    $ evalBadRemyJoke = False



    #A bunch of variables for the orphanage minigame

    #Variable that toggles certain dialogue for increased continuity
    $ evalJumpFromMain = False

    #Variable to account if Remy was gone while you turned on the lights
    $ evalLightsOnWithoutRemy = False

    #Whether you have fixed the lights based on progress. Completes at 2
    $ evalReplaceBulbs = False
    $ evalResetBreaker = False
    $ evalReplaceSwitch = False

    #Whether you have fixed the desk based on progress. Completes at 2
    $ evalApplyDWD = False
    $ evalFixLeg = False
    $ evalFixSeat = False

    #Whether you have organized the books based on progress. Completes at 3
    $ evalPickUpBooks = False
    $ evalUncrumpleProgress = 0
    $ evalUncrumplePages = False
    $ evalSortBooks = False

    #Whether you sorted through the papers based on progress. Completes at 3
    $ evalHatchlingArt = False
    $ evalPaperwork = False
    $ evalFoldNewspaper = False
    $ evalAmelyPicture = False #Make sure to reference this later

    #Whether you cleaned everything based on progress. Completes at 3
    $ evalCleanWalls = False
    $ evalCleanDesks = False
    $ evalCleanWhiteboard = False

    #How many actions Remy will be gone for and handling his return
    $ evalMinutesRemyIsGone = 0
    $ evalRemyOnMission = False
    $ evalRemyItem = ""

    #How many minutes you get before your time is up. Base 15? 20? 25? I'll balance it once I finish
    $ evalRemainingMinutes = 250

    #How many tasks have been completed. Completes at 5
    $ evalTasksComplete = 0

    #What text to display when the user asks what to do next in the menu
    $ evalWhatNextText = ""

    #Lists of items the player has
    $ evalGatheredItems = []

    #Variables for when Vara leaves in the orphanage minigame
    $ evalVaraGone = False
    $ evalRemyAsksAboutVara = False
    $ evalVaraSnack = False
    $ evalRemyGoneWhileSnack = False
    $ evalCrackersConsumed = 0
    $ evalJustAteCracker = False

    #Tie-in with Remy Hatchlings mod as an alternate way to get the secret ending. I need to move this later
    $ evalVaraSurvives = False
    if renpy.python.store_dicts["store"].get("hatchling", "") == "Vara":
        $ evalVaraSurvives = True

    python:
        if not persistent.evalSecretEndingUnlocked: #[REDACTED]
            persistent.evalSecretEndingUnlocked = False
        if not persistent.evalFirstSecretUnlock:
            persistent.evalFirstSecretUnlock = True
        
        #Endings
        if not persistent.evalEndingA: #Unlike ECK, endings aren't named and "A" isn't the best
            persistent.evalEndingA = False #Just Remy - Vanilla
        if not persistent.evalEndingB:
            persistent.evalEndingB = False #Remy and Amely - Strawberry
        if not persistent.evalEndingC:
            persistent.evalEndingC = False #Remy, Amely, and Adine - Mango
        if not persistent.evalEndingD:
            persistent.evalEndingD = False #Everyone - Cherry
        
        if not persistent.evalEndingBUnlocked:
            persistent.evalEndingBUnlocked = False
        if not persistent.evalEndingCUnlocked:
            persistent.evalEndingCUnlocked = False
        
        #Fails
        if not persistent.evalUniqueFails:
            persistent.evalUniqueFails = []
        if not persistent.evalGogglesScene:
            persistent.evalGogglesScene = False
        
        #Skips

        #General Skips
        if not persistent.evalOrphanageTripSkip:
            persistent.evalOrphanageTripSkip = False
        if not persistent.evalOrphanageSleepSkip:
            persistent.evalOrphanageSleepSkip = False

        #Ending A
        if not persistent.evalA1Skip:
            persistent.evalA1Skip = False
        if not persistent.evalA2Skip:
            persistent.evalA2Skip = False
        
        #Ending B
        if not persistent.evalB1Skip:
            persistent.evalB1Skip = False

        #Ending C
        if not persistent.evalC1Skip:
            persistent.evalC1Skip = False
        if not persistent.evalC2Skip:
            persistent.evalC2Skip = False

        #Ending D
        if not persistent.evalD1Skip:
            persistent.evalD1Skip = False
        
    #Unique fails/quick endings
    $ evalFail = ""
    $ evalTotalFails = 0
    
    #Stuff for orphanage minigame display. Thanks EvilChaosKnight :)
    $ evalDisplayVar1name = ""
    $ evalDisplayVar1 = 0
    $ evalDisplayVar1unit = ""
    $ evalDisplayVar1sec = 0

    $ evalDisplayVar2name = ""
    $ evalDisplayVar2 = 0
    $ evalDisplayVar2unit = ""
    $ evalDisplayVar3name = ""
    $ evalDisplayVar3 = 0
    $ evalDisplayVar3unit = ""
    $ evalDisplayVar4name = ""
    $ evalDisplayVar4 = 0
    $ evalDisplayVar4unit = ""
    $ evalDisplayVar5name = ""
    $ evalDisplayVar5 = 0
    $ evalDisplayVar5unit = ""
    $ evalDisplayVar6name = ""
    $ evalDisplayVar6 = 0
    $ evalDisplayVar6unit = ""
    $ evalDisplayVar7name = ""
    $ evalDisplayVar7 = 0
    $ evalDisplayVar7unit = ""
    $ evalDisplayVar8name = ""
    $ evalDisplayVar8 = 0
    $ evalDisplayVar8unit = ""

    return

label eval_tdomi_early:
    $ evalMetLucius = False
    $ evalMetKalinth = False
    $ evalMetDram = False

    return

label eval_extended_ending:
    #Updated to require the player to meet with katsu every playthrough they want the ending
    if chap3picka == "katsu" or chap3pickb == "katsu":
        jump eval_tdomi_remy
    elif evalPathToSecretComplete:
        play sound "fx/system3.wav"
        s "You saved Vara, but there is still more to her story..."
        stop music fadeout 2.0
        scene black with dissolveslow
        return